[2025-05-05T22:16:00.671+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data scheduled__2025-05-05T22:15:00+00:00 [queued]>
[2025-05-05T22:16:00.680+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data scheduled__2025-05-05T22:15:00+00:00 [queued]>
[2025-05-05T22:16:00.680+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-05-05T22:16:00.695+0000] {taskinstance.py:2191} INFO - Executing <Task(_PythonDecoratedOperator): extract_mongo_data> on 2025-05-05 22:15:00+00:00
[2025-05-05T22:16:00.700+0000] {standard_task_runner.py:60} INFO - Started process 5348 to run task
[2025-05-05T22:16:00.704+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'mymind_mongo_to_mysql_etl', 'extract_mongo_data', 'scheduled__2025-05-05T22:15:00+00:00', '--job-id', '32085', '--raw', '--subdir', 'DAGS_FOLDER/mymind_etl_dag.py', '--cfg-path', '/tmp/tmpq7wjc4qi']
[2025-05-05T22:16:00.705+0000] {standard_task_runner.py:88} INFO - Job 32085: Subtask extract_mongo_data
[2025-05-05T22:16:00.761+0000] {task_command.py:423} INFO - Running <TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data scheduled__2025-05-05T22:15:00+00:00 [running]> on host 52beca4b988b
[2025-05-05T22:16:00.861+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='mymind_mongo_to_mysql_etl' AIRFLOW_CTX_TASK_ID='extract_mongo_data' AIRFLOW_CTX_EXECUTION_DATE='2025-05-05T22:15:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-05-05T22:15:00+00:00'
[2025-05-05T22:16:00.862+0000] {mymind_etl_dag.py:59} INFO - Iniciando extracción desde MongoDB (usando MongoClient directo)...
[2025-05-05T22:16:00.863+0000] {mymind_etl_dag.py:63} INFO - Obteniendo detalles de conexión para mongo_mymind...
[2025-05-05T22:16:00.876+0000] {base.py:83} INFO - Using connection ID 'mongo_mymind' for task execution.
[2025-05-05T22:16:00.877+0000] {mymind_etl_dag.py:94} INFO - URI de MongoDB construida correctamente.
[2025-05-05T22:16:00.877+0000] {mymind_etl_dag.py:99} INFO - Timeouts - Connect: 10000ms, ServerSelect: 30000ms
[2025-05-05T22:16:00.877+0000] {mymind_etl_dag.py:102} INFO - Creando instancia de MongoClient...
[2025-05-05T22:16:00.883+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/pymongo/uri_parser.py:329: UserWarning: Unknown option: allow_insecure. Did you mean one of (tlsinsecure, tlsallowinvalidhostnames, tlsallowinvalidcertificates) or maybe a camelCase version of one? Refer to docstring.
  return get_validated_options(opts, warn)

[2025-05-05T22:16:01.367+0000] {mymind_etl_dag.py:112} INFO - Probando conexión con MongoDB (ping)...
[2025-05-05T22:16:02.228+0000] {mymind_etl_dag.py:114} INFO - Conexión a MongoDB exitosa.
[2025-05-05T22:16:02.229+0000] {mymind_etl_dag.py:119} INFO - Accediendo a DB: 'myMindDB-Users', Colección: 'users'
[2025-05-05T22:16:02.229+0000] {mymind_etl_dag.py:122} INFO - Realizando find en la colección...
[2025-05-05T22:16:02.314+0000] {mymind_etl_dag.py:142} INFO - Se extrajeron 5 documentos de MongoDB. Iniciando conversión de tipos BSON...
[2025-05-05T22:16:02.315+0000] {mymind_etl_dag.py:153} INFO - Conversión de tipos completada. 5 documentos listos para XCom.
[2025-05-05T22:16:02.316+0000] {mymind_etl_dag.py:164} INFO - Cerrando conexión MongoClient.
[2025-05-05T22:16:02.400+0000] {python.py:201} INFO - Done. Returned value was: [{'_id': 'auth0|67ec68c74000acd49b9bfec7', 'name': 'Test User', 'email': 'testuser@example.com', 'profilePic': 'https://new-url-pictures.com/pic.png', 'birthdate': '2000-01-01', 'city': 'Bogotá', 'personality': 'Introvertido', 'university': 'Pontificia Universidad Javeriana', 'degree': 'Ingeniería de Sistemas', 'gender': 'Masculino', 'notifications': False, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-13T01:23:00', 'acceptance_ip': '192.168.0.1', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '6817d4ae6cad195648dad37d', 'date': '2025-05-04', 'time': '15:57:18', 'text': 'hoy hable con la persona que me gusta, me senti bastante emocionado porque antes no habia tenido el valor para hablarle, pero por fin lo hice', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0263, 'anger': 0.0566, 'sadness': 0.0271, 'disgust': 0.0519, 'fear': 0.5277, 'neutral': 0.0376, 'surprise': 0.0492, 'trust': 0.0846, 'anticipation': 0.139}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9115, 'negative': 0.008, 'neutral': 0.0805}, 'topic': None}]}, {'_id': 'auth0|68056efbe5667a7f08ed848a', 'name': 'Natalia Mejia', 'email': 'nataliamejia@javeriana.edu.co', 'profilePic': 'https://res.cloudinary.com/dkm4nlyxr/image/upload/v1746421291/profileImages/kgdhr8robviu3vdjegox.jpg', 'birthdate': '2025-04-08', 'city': 'Cali', 'personality': 'Introvertido', 'university': 'Javeriana', 'degree': 'Sistemas', 'gender': 'Femenino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-20T22:02:34.869000', 'acceptance_ip': '10.0.2.16', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '681900d8a35b6c7b783123ef', 'date': '2025-05-05', 'time': '13:18:00', 'text': 'todo bien hola hola todo bien todo bien todo bien todo bien hola hola', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0753, 'anger': 0.1291, 'sadness': 0.0903, 'disgust': 0.0915, 'fear': 0.2489, 'neutral': 0.0878, 'surprise': 0.0582, 'trust': 0.0864, 'anticipation': 0.1325}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.84, 'negative': 0.0086, 'neutral': 0.1514}, 'topic': None}, {'_id': '681901dea35b6c7b783123f0', 'date': '2025-05-05', 'time': '13:22:22', 'text': 'tal catal catal canta', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0512, 'anger': 0.0962, 'sadness': 0.0766, 'disgust': 0.1144, 'fear': 0.2677, 'neutral': 0.0876, 'surprise': 0.0982, 'trust': 0.0965, 'anticipation': 0.1117}, 'sentiment': 'neutral', 'sentimentProbabilities': {'positive': 0.2107, 'negative': 0.1731, 'neutral': 0.6162}, 'topic': None}, {'_id': '681900d8a35b6c7b783123ef', 'date': '2025-05-05', 'time': '13:18:00', 'text': 'todo bien hola hola todo bien todo bien todo bien todo bien hola hola', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0753, 'anger': 0.1291, 'sadness': 0.0903, 'disgust': 0.0915, 'fear': 0.2489, 'neutral': 0.0878, 'surprise': 0.0582, 'trust': 0.0864, 'anticipation': 0.1325}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.84, 'negative': 0.0086, 'neutral': 0.1514}, 'topic': None}, {'_id': '681900d8a35b6c7b783123ef', 'date': '2025-05-05', 'time': '13:18:00', 'text': 'todo bien hola hola todo bien todo bien todo bien todo bien hola hola', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0753, 'anger': 0.1291, 'sadness': 0.0903, 'disgust': 0.0915, 'fear': 0.2489, 'neutral': 0.0878, 'surprise': 0.0582, 'trust': 0.0864, 'anticipation': 0.1325}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.84, 'negative': 0.0086, 'neutral': 0.1514}, 'topic': None}, {'_id': '681900d8a35b6c7b783123ef', 'date': '2025-05-05', 'time': '13:18:00', 'text': 'todo bien hola hola todo bien todo bien todo bien todo bien hola hola', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0753, 'anger': 0.1291, 'sadness': 0.0903, 'disgust': 0.0915, 'fear': 0.2489, 'neutral': 0.0878, 'surprise': 0.0582, 'trust': 0.0864, 'anticipation': 0.1325}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.84, 'negative': 0.0086, 'neutral': 0.1514}, 'topic': None}, {'_id': '681900d8a35b6c7b783123ef', 'date': '2025-05-05', 'time': '13:18:00', 'text': 'todo bien hola hola todo bien todo bien todo bien todo bien hola hola', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0753, 'anger': 0.1291, 'sadness': 0.0903, 'disgust': 0.0915, 'fear': 0.2489, 'neutral': 0.0878, 'surprise': 0.0582, 'trust': 0.0864, 'anticipation': 0.1325}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.84, 'negative': 0.0086, 'neutral': 0.1514}, 'topic': None}, {'_id': '681900d8a35b6c7b783123ef', 'date': '2025-05-05', 'time': '13:18:00', 'text': 'todo bien hola hola todo bien todo bien todo bien todo bien hola hola', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0753, 'anger': 0.1291, 'sadness': 0.0903, 'disgust': 0.0915, 'fear': 0.2489, 'neutral': 0.0878, 'surprise': 0.0582, 'trust': 0.0864, 'anticipation': 0.1325}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.84, 'negative': 0.0086, 'neutral': 0.1514}, 'topic': None}, {'_id': '681900d8a35b6c7b783123ef', 'date': '2025-05-05', 'time': '13:18:00', 'text': 'todo bien hola hola todo bien todo bien todo bien todo bien hola hola', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0753, 'anger': 0.1291, 'sadness': 0.0903, 'disgust': 0.0915, 'fear': 0.2489, 'neutral': 0.0878, 'surprise': 0.0582, 'trust': 0.0864, 'anticipation': 0.1325}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.84, 'negative': 0.0086, 'neutral': 0.1514}, 'topic': None}, {'_id': '681900d8a35b6c7b783123ef', 'date': '2025-05-05', 'time': '13:18:00', 'text': 'todo bien hola hola todo bien todo bien todo bien todo bien hola hola', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0753, 'anger': 0.1291, 'sadness': 0.0903, 'disgust': 0.0915, 'fear': 0.2489, 'neutral': 0.0878, 'surprise': 0.0582, 'trust': 0.0864, 'anticipation': 0.1325}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.84, 'negative': 0.0086, 'neutral': 0.1514}, 'topic': None}, {'_id': '681900d8a35b6c7b783123ef', 'date': '2025-05-05', 'time': '13:18:00', 'text': 'todo bien hola hola todo bien todo bien todo bien todo bien hola hola', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0753, 'anger': 0.1291, 'sadness': 0.0903, 'disgust': 0.0915, 'fear': 0.2489, 'neutral': 0.0878, 'surprise': 0.0582, 'trust': 0.0864, 'anticipation': 0.1325}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.84, 'negative': 0.0086, 'neutral': 0.1514}, 'topic': None}, {'_id': '681900d8a35b6c7b783123ef', 'date': '2025-05-05', 'time': '13:18:00', 'text': 'todo bien hola hola todo bien todo bien todo bien todo bien hola hola', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0753, 'anger': 0.1291, 'sadness': 0.0903, 'disgust': 0.0915, 'fear': 0.2489, 'neutral': 0.0878, 'surprise': 0.0582, 'trust': 0.0864, 'anticipation': 0.1325}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.84, 'negative': 0.0086, 'neutral': 0.1514}, 'topic': None}, {'_id': '681900d8a35b6c7b783123ef', 'date': '2025-05-05', 'time': '13:18:00', 'text': 'todo bien hola hola todo bien todo bien todo bien todo bien hola hola', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0753, 'anger': 0.1291, 'sadness': 0.0903, 'disgust': 0.0915, 'fear': 0.2489, 'neutral': 0.0878, 'surprise': 0.0582, 'trust': 0.0864, 'anticipation': 0.1325}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.84, 'negative': 0.0086, 'neutral': 0.1514}, 'topic': None}]}, {'_id': 'auth0|68ab12cd5678def90c1a2b34', 'name': 'Juan Pérez2', 'email': 'juanperez@example.com', 'profilePic': 'https://example.com/juan_avatar.png', 'birthdate': '1998-05-15', 'city': 'Medellín', 'personality': 'Extrovertido', 'university': 'Universidad de Antioquia', 'degree': 'Psicología', 'gender': 'Masculino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-10T14:30:00', 'acceptance_ip': '192.168.1.100', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '6812e789a45b123cd890ef12', 'date': '2025-04-15', 'time': '09:15:22', 'text': 'hoy tuve una presentación en la universidad y me fue increíble, todos aplaudieron y el profe me felicitó, estoy súper feliz', 'emotion': 'joy', 'emotionProbabilities': {'joy': 0.75, 'anger': 0.01, 'sadness': 0.02, 'disgust': 0.005, 'fear': 0.015, 'neutral': 0.1, 'surprise': 0.05, 'trust': 0.04, 'anticipation': 0.01}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.92, 'negative': 0.03, 'neutral': 0.05}, 'topic': 'éxito académico'}, {'_id': '6812f901b67c456ef901ab23', 'date': '2025-04-20', 'time': '17:45:10', 'text': 'se me pinchó la llanta de la bici camino a casa, tuve que caminar un montón y llegué agotado', 'emotion': 'sadness', 'emotionProbabilities': {'joy': 0.05, 'anger': 0.1, 'sadness': 0.6, 'disgust': 0.03, 'fear': 0.07, 'neutral': 0.08, 'surprise': 0.02, 'trust': 0.01, 'anticipation': 0.04}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.04, 'negative': 0.85, 'neutral': 0.11}, 'topic': 'inconveniente transporte'}]}, {'_id': 'auth0|6813c1d455192958d462175a', 'name': 'Laura Mejia Estrada', 'email': 'natismejiacil@gmail.com', 'profilePic': 'https://res.cloudinary.com/dkm4nlyxr/image/upload/v1746425277/profileImages/eubrdbefutckduypmjts.jpg', 'birthdate': '2002-05-09', 'city': 'Bogota', 'personality': 'Introvertido', 'university': 'Andes', 'degree': 'Historia', 'gender': 'Femenino', 'notifications': False, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-01T18:47:48.890000', 'acceptance_ip': '192.168.80.14', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': []}, {'_id': 'auth0|6818f379b978c1fa5d0acb84', 'name': 'nat', 'email': 'bekexin947@bocapies.com', 'profilePic': 'https://res.cloudinary.com/dkm4nlyxr/image/upload/v1746465655/profileImages/riwwkvm7802chnbwkis4.jpg', 'birthdate': '1983-05-05', 'city': 'cali', 'personality': 'Extrovertido', 'university': 'jave', 'degree': 'sistemas', 'gender': 'Omitido', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-05T17:20:57.345000', 'acceptance_ip': '192.168.80.16', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '6818fc97a35b6c7b783123ee', 'date': '2025-05-05', 'time': '12:59:51', 'text': 'hoy me levanté tan estuve feliz y todo la verdad muy bien', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0304, 'anger': 0.0618, 'sadness': 0.0288, 'disgust': 0.0428, 'fear': 0.5429, 'neutral': 0.0384, 'surprise': 0.0413, 'trust': 0.0724, 'anticipation': 0.1413}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9668, 'negative': 0.0052, 'neutral': 0.0281}, 'topic': None}]}]
[2025-05-05T22:16:02.443+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=mymind_mongo_to_mysql_etl, task_id=extract_mongo_data, execution_date=20250505T221500, start_date=20250505T221600, end_date=20250505T221602
[2025-05-05T22:16:02.480+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-05-05T22:16:02.520+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
