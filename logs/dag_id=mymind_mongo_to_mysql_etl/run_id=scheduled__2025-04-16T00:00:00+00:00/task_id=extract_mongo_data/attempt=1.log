[2025-04-17T00:00:01.336+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data scheduled__2025-04-16T00:00:00+00:00 [queued]>
[2025-04-17T00:00:01.344+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data scheduled__2025-04-16T00:00:00+00:00 [queued]>
[2025-04-17T00:00:01.344+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-04-17T00:00:01.359+0000] {taskinstance.py:2191} INFO - Executing <Task(_PythonDecoratedOperator): extract_mongo_data> on 2025-04-16 00:00:00+00:00
[2025-04-17T00:00:01.364+0000] {standard_task_runner.py:60} INFO - Started process 25197 to run task
[2025-04-17T00:00:01.368+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'mymind_mongo_to_mysql_etl', 'extract_mongo_data', 'scheduled__2025-04-16T00:00:00+00:00', '--job-id', '26', '--raw', '--subdir', 'DAGS_FOLDER/mymind_etl_dag.py', '--cfg-path', '/tmp/tmpgh___24d']
[2025-04-17T00:00:01.370+0000] {standard_task_runner.py:88} INFO - Job 26: Subtask extract_mongo_data
[2025-04-17T00:00:01.417+0000] {task_command.py:423} INFO - Running <TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data scheduled__2025-04-16T00:00:00+00:00 [running]> on host 64c6827685b2
[2025-04-17T00:00:01.514+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='mymind_mongo_to_mysql_etl' AIRFLOW_CTX_TASK_ID='extract_mongo_data' AIRFLOW_CTX_EXECUTION_DATE='2025-04-16T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-04-16T00:00:00+00:00'
[2025-04-17T00:00:01.515+0000] {mymind_etl_dag.py:59} INFO - Iniciando extracción desde MongoDB (usando MongoClient directo)...
[2025-04-17T00:00:01.515+0000] {mymind_etl_dag.py:63} INFO - Obteniendo detalles de conexión para mongo_mymind...
[2025-04-17T00:00:01.527+0000] {base.py:83} INFO - Using connection ID 'mongo_mymind' for task execution.
[2025-04-17T00:00:01.528+0000] {mymind_etl_dag.py:94} INFO - URI de MongoDB construida correctamente.
[2025-04-17T00:00:01.528+0000] {mymind_etl_dag.py:99} INFO - Timeouts - Connect: 10000ms, ServerSelect: 30000ms
[2025-04-17T00:00:01.528+0000] {mymind_etl_dag.py:102} INFO - Creando instancia de MongoClient...
[2025-04-17T00:00:01.534+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/pymongo/uri_parser.py:329: UserWarning: Unknown option: allow_insecure. Did you mean one of (tlsinsecure, tlsallowinvalidhostnames, tlsallowinvalidcertificates) or maybe a camelCase version of one? Refer to docstring.
  return get_validated_options(opts, warn)

[2025-04-17T00:00:01.815+0000] {mymind_etl_dag.py:113} INFO - Probando conexión con MongoDB (ping)...
[2025-04-17T00:00:02.963+0000] {mymind_etl_dag.py:115} INFO - Conexión a MongoDB exitosa.
[2025-04-17T00:00:02.963+0000] {mymind_etl_dag.py:120} INFO - Accediendo a DB: 'myMindDB-Users', Colección: 'users'
[2025-04-17T00:00:02.964+0000] {mymind_etl_dag.py:123} INFO - Realizando find en la colección...
[2025-04-17T00:00:03.054+0000] {mymind_etl_dag.py:141} INFO - Se extrajeron 4 documentos de MongoDB. Iniciando conversión de tipos BSON...
[2025-04-17T00:00:03.055+0000] {mymind_etl_dag.py:152} INFO - Conversión de tipos completada. 4 documentos listos para XCom.
[2025-04-17T00:00:03.055+0000] {mymind_etl_dag.py:163} INFO - Cerrando conexión MongoClient.
[2025-04-17T00:00:03.144+0000] {python.py:201} INFO - Done. Returned value was: [{'_id': 'auth0|67ec68c74000acd49b9bfec7', 'name': 'Test User', 'email': 'testuser@example.com', 'profilePic': 'https://example.com/avatar.png', 'birthdate': '2000-01-01', 'city': 'Bogotá', 'personality': 'Introvertido', 'university': 'Pontificia Universidad Javeriana', 'degree': 'Ingeniería de Sistemas', 'gender': 'Masculino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-13T01:23:00', 'acceptance_ip': '192.168.0.1', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '67fc05e7d3c7772ff75c31fb', 'date': '2025-04-13', 'time': '14:30', 'text': 'Hoy me sentí muy motivado después de estudiar para el examen.', 'emotion': 'happy', 'emotionProbabilities': {'happy': 0.85, 'neutral': 0.1, 'sad': 0.05}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9, 'neutral': 0.05, 'negative': 0.05}, 'topic': ''}, {'_id': '67fc19b7d3c7772ff75c31fc', 'date': '2025-04-13', 'time': '15:30', 'text': 'Hoy me sentí muy triste.', 'emotion': 'sadness', 'emotionProbabilities': {'happy': 0.05, 'neutral': 0.1, 'sad': 0.85}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.05, 'neutral': 0.05, 'negative': 0.9}, 'topic': ''}]}, {'_id': 'auth0|67ec68c74000acd49b9bfec8', 'name': 'Ana Gómez', 'email': 'anagomez@example.com', 'profilePic': 'https://example.com/avatar2.png', 'birthdate': '1998-05-15', 'city': 'Medellín', 'personality': 'Extrovertida', 'university': 'Universidad de Antioquia', 'degree': 'Psicología', 'gender': 'Femenino', 'notifications': False, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-14T10:15:00', 'acceptance_ip': '192.168.0.2', 'privacy_preferences': {'allow_anonimized_usage': False}}, 'transcriptions': [{'_id': '67fc05e7d3c7772ff75c31fd', 'date': '2025-04-14', 'time': '09:00', 'text': 'Tuve una gran conversación con mis amigos en la universidad.', 'emotion': 'happy', 'emotionProbabilities': {'happy': 0.9, 'neutral': 0.05, 'sad': 0.05}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.95, 'neutral': 0.03, 'negative': 0.02}, 'topic': ''}, {'_id': '67fc19b7d3c7772ff75c31fe', 'date': '2025-04-14', 'time': '16:45', 'text': 'Me preocupa no haber preparado bien mi presentación.', 'emotion': 'anxiety', 'emotionProbabilities': {'happy': 0.05, 'neutral': 0.15, 'sad': 0.8}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.05, 'neutral': 0.1, 'negative': 0.85}, 'topic': ''}]}, {'_id': 'auth0|67ec68c74000acd49b9bfec9', 'name': 'Carlos Ramírez', 'email': 'carlosramirez@example.com', 'profilePic': 'https://example.com/avatar3.png', 'birthdate': '2001-11-22', 'city': 'Cali', 'personality': 'Ambivertido', 'university': 'Universidad del Valle', 'degree': 'Ingeniería Civil', 'gender': 'Masculino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-13T18:40:00', 'acceptance_ip': '192.168.0.3', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '67fc05e7d3c7772ff75c31ff', 'date': '2025-04-13', 'time': '11:20', 'text': 'Disfruté mucho trabajando en el proyecto de diseño estructural.', 'emotion': 'happy', 'emotionProbabilities': {'happy': 0.88, 'neutral': 0.1, 'sad': 0.02}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.92, 'neutral': 0.05, 'negative': 0.03}, 'topic': ''}, {'_id': '67fc19b7d3c7772ff75c3200', 'date': '2025-04-13', 'time': '19:10', 'text': 'Me siento agotado después de tantas horas de estudio.', 'emotion': 'tired', 'emotionProbabilities': {'happy': 0.05, 'neutral': 0.2, 'sad': 0.75}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.05, 'neutral': 0.15, 'negative': 0.8}, 'topic': ''}]}, {'_id': 'auth0|67ec68c74000acd49b9bfeca', 'name': 'Laura Martínez', 'email': 'lauramartinez@example.com', 'profilePic': 'https://example.com/avatar4.png', 'birthdate': '1999-03-10', 'city': 'Barranquilla', 'personality': 'Introvertida', 'university': 'Universidad del Norte', 'degree': 'Administración de Empresas', 'gender': 'Femenino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-15T08:30:00', 'acceptance_ip': '192.168.0.4', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '67fc05e7d3c7772ff75c3201', 'date': '2025-04-15', 'time': '07:50', 'text': 'Me siento lista para la reunión de hoy con el equipo de marketing.', 'emotion': 'confident', 'emotionProbabilities': {'happy': 0.85, 'neutral': 0.1, 'sad': 0.05}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9, 'neutral': 0.08, 'negative': 0.02}, 'topic': ''}, {'_id': '67fc19b7d3c7772ff75c3202', 'date': '2025-04-15', 'time': '13:00', 'text': 'No logré convencer al cliente en la presentación, me siento frustrada.', 'emotion': 'frustration', 'emotionProbabilities': {'happy': 0.05, 'neutral': 0.1, 'sad': 0.85}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.05, 'neutral': 0.05, 'negative': 0.9}, 'topic': ''}]}]
[2025-04-17T00:00:03.185+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=mymind_mongo_to_mysql_etl, task_id=extract_mongo_data, execution_date=20250416T000000, start_date=20250417T000001, end_date=20250417T000003
[2025-04-17T00:00:03.225+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-04-17T00:00:03.273+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
