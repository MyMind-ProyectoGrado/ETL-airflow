[2025-05-12T16:50:03.282+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data manual__2025-05-12T16:50:02+00:00 [queued]>
[2025-05-12T16:50:03.291+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data manual__2025-05-12T16:50:02+00:00 [queued]>
[2025-05-12T16:50:03.292+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-05-12T16:50:03.309+0000] {taskinstance.py:2191} INFO - Executing <Task(_PythonDecoratedOperator): extract_mongo_data> on 2025-05-12 16:50:02+00:00
[2025-05-12T16:50:03.314+0000] {standard_task_runner.py:60} INFO - Started process 1616 to run task
[2025-05-12T16:50:03.317+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'mymind_mongo_to_mysql_etl', 'extract_mongo_data', 'manual__2025-05-12T16:50:02+00:00', '--job-id', '35997', '--raw', '--subdir', 'DAGS_FOLDER/mymind_etl_dag.py', '--cfg-path', '/tmp/tmpnbkdbuw1']
[2025-05-12T16:50:03.319+0000] {standard_task_runner.py:88} INFO - Job 35997: Subtask extract_mongo_data
[2025-05-12T16:50:03.367+0000] {task_command.py:423} INFO - Running <TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data manual__2025-05-12T16:50:02+00:00 [running]> on host 05e28894127a
[2025-05-12T16:50:03.448+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='mymind_mongo_to_mysql_etl' AIRFLOW_CTX_TASK_ID='extract_mongo_data' AIRFLOW_CTX_EXECUTION_DATE='2025-05-12T16:50:02+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-12T16:50:02+00:00'
[2025-05-12T16:50:03.449+0000] {mymind_etl_dag.py:60} INFO - Iniciando extracción desde MongoDB (usando MongoClient directo)...
[2025-05-12T16:50:03.449+0000] {mymind_etl_dag.py:64} INFO - Obteniendo detalles de conexión para mongo_mymind...
[2025-05-12T16:50:03.462+0000] {base.py:83} INFO - Using connection ID 'mongo_mymind' for task execution.
[2025-05-12T16:50:03.463+0000] {mymind_etl_dag.py:95} INFO - URI de MongoDB construida correctamente.
[2025-05-12T16:50:03.463+0000] {mymind_etl_dag.py:100} INFO - Timeouts - Connect: 10000ms, ServerSelect: 30000ms
[2025-05-12T16:50:03.463+0000] {mymind_etl_dag.py:103} INFO - Creando instancia de MongoClient...
[2025-05-12T16:50:03.468+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/pymongo/uri_parser.py:329: UserWarning: Unknown option: allow_insecure. Did you mean one of (tlsinsecure, tlsallowinvalidhostnames, tlsallowinvalidcertificates) or maybe a camelCase version of one? Refer to docstring.
  return get_validated_options(opts, warn)

[2025-05-12T16:50:03.575+0000] {mymind_etl_dag.py:113} INFO - Probando conexión con MongoDB (ping)...
[2025-05-12T16:50:04.470+0000] {mymind_etl_dag.py:115} INFO - Conexión a MongoDB exitosa.
[2025-05-12T16:50:04.471+0000] {mymind_etl_dag.py:120} INFO - Accediendo a DB: 'myMindDB-Users', Colección: 'users'
[2025-05-12T16:50:04.471+0000] {mymind_etl_dag.py:123} INFO - Realizando find en la colección...
[2025-05-12T16:50:04.555+0000] {mymind_etl_dag.py:143} INFO - Se extrajeron 7 documentos de MongoDB. Iniciando conversión de tipos BSON...
[2025-05-12T16:50:04.556+0000] {mymind_etl_dag.py:154} INFO - Conversión de tipos completada. 7 documentos listos para XCom.
[2025-05-12T16:50:04.556+0000] {mymind_etl_dag.py:165} INFO - Cerrando conexión MongoClient.
[2025-05-12T16:50:04.640+0000] {python.py:201} INFO - Done. Returned value was: [{'_id': 'auth0|67ec68c74000acd49b9bfec7', 'name': 'Test User', 'email': 'testuser@example.com', 'profilePic': 'https://new-url-picture.com/pic.png', 'birthdate': '2000-01-01', 'city': 'Bogotá', 'personality': 'Introvertido', 'university': 'Pontificia Universidad Javeriana', 'degree': 'Ingeniería de Sistemas', 'gender': 'Masculino', 'notifications': False, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-13T01:23:00', 'acceptance_ip': '192.168.0.1', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '681f8ac3e95809a68716ca4f', 'date': '2025-05-10', 'time': '12:20:03', 'text': 'hoy estaba caminando me había comprado mi café para irme a clase y había una baldosa salida me tropecé me cayó el café me cayó encima me quemé entero tuve que ir al baño secarme a limpiarme llegué tarde a clase como veinte minutos sí', 'emotion': 'disgust', 'emotionProbabilities': {'joy': 0.0265, 'anger': 0.1301, 'sadness': 0.0272, 'disgust': 0.5519, 'fear': 0.1242, 'neutral': 0.0381, 'surprise': 0.0096, 'trust': 0.0684, 'anticipation': 0.0241}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.0058, 'negative': 0.8931, 'neutral': 0.101}, 'topic': None}]}, {'_id': 'auth0|68056efbe5667a7f08ed848a', 'name': 'Natalia Mejia', 'email': 'nataliamejia@javeriana.edu.co', 'profilePic': 'https://res.cloudinary.com/dkm4nlyxr/image/upload/v1746421291/profileImages/kgdhr8robviu3vdjegox.jpg', 'birthdate': '2025-04-08', 'city': 'Cali', 'personality': 'Introvertido', 'university': 'Javeriana', 'degree': 'Sistemas', 'gender': 'Femenino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-20T22:02:34.869000', 'acceptance_ip': '10.0.2.16', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '68193e4c0e9b2121ab849662', 'date': '2025-05-05', 'time': '17:40:12', 'text': 'hola tal cosa hoy fue un buen día me sentí muy feliz estuvo bien chére no pues nada todo bien y eso fue tal otra cosa no sé cuánto en', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0449, 'anger': 0.0756, 'sadness': 0.0464, 'disgust': 0.0451, 'fear': 0.5341, 'neutral': 0.0594, 'surprise': 0.0571, 'trust': 0.043, 'anticipation': 0.0944}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9236, 'negative': 0.0054, 'neutral': 0.071}, 'topic': None}, {'_id': '681d38bbdbd899fa55ad4124', 'date': '2025-05-08', 'time': '18:05:31', 'text': 'el día de hoy la verdad me siento como un puto culo estoy cansada soy mamá jerencia me tiene hasta los nuevos que tanto más la bien dura la verdad me siento muy triste', 'emotion': 'anger', 'emotionProbabilities': {'joy': 0.0261, 'anger': 0.3965, 'sadness': 0.2754, 'disgust': 0.1598, 'fear': 0.084, 'neutral': 0.0138, 'surprise': 0.0192, 'trust': 0.0068, 'anticipation': 0.0185}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.0033, 'negative': 0.9825, 'neutral': 0.0143}, 'topic': None}, {'_id': '681d3923dbd899fa55ad4125', 'date': '2025-05-08', 'time': '18:07:15', 'text': 'no ahí me ha sido siempre que ha sido un día muy feliz supongo miedo no sé había sido muy bendita estaba muy feliz amo la vida todo ha salido excelente hoy amo gerencia de personas de alma eran tinto no me dieron tinto', 'emotion': 'joy', 'emotionProbabilities': {'joy': 0.3558, 'anger': 0.0169, 'sadness': 0.0222, 'disgust': 0.0119, 'fear': 0.009, 'neutral': 0.0455, 'surprise': 0.3425, 'trust': 0.0219, 'anticipation': 0.1743}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9061, 'negative': 0.006, 'neutral': 0.0879}, 'topic': None}, {'_id': '681d3a79dbd899fa55ad4126', 'date': '2025-05-08', 'time': '18:12:57', 'text': 'me pareció que fue muy buen día la verdad que fue muy feliz fue un momento bastante motivo el cerré la sotología pero de manera general fue un excelente excelente día', 'emotion': 'surprise', 'emotionProbabilities': {'joy': 0.3257, 'anger': 0.0219, 'sadness': 0.0194, 'disgust': 0.0129, 'fear': 0.0111, 'neutral': 0.0264, 'surprise': 0.4341, 'trust': 0.0173, 'anticipation': 0.1312}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.969, 'negative': 0.0029, 'neutral': 0.0281}, 'topic': None}]}, {'_id': 'auth0|6813c1d455192958d462175a', 'name': 'Laura Mejia Estrada', 'email': 'natismejiacil@gmail.com', 'profilePic': 'https://res.cloudinary.com/dkm4nlyxr/image/upload/v1746425277/profileImages/eubrdbefutckduypmjts.jpg', 'birthdate': '2002-05-09', 'city': 'Bogota', 'personality': 'Introvertido', 'university': 'Andes', 'degree': 'Historia', 'gender': 'Femenino', 'notifications': False, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-01T18:47:48.890000', 'acceptance_ip': '192.168.80.14', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '68217a31dd8819a73402f93f', 'date': '2025-05-11', 'time': '23:33:53', 'text': 'hola tal tal prueba unos tres prueba prueba estamos viendo perfecto felicidad', 'emotion': 'joy', 'emotionProbabilities': {'joy': 0.3641, 'anger': 0.0267, 'sadness': 0.0246, 'disgust': 0.0204, 'fear': 0.0173, 'neutral': 0.0876, 'surprise': 0.233, 'trust': 0.0442, 'anticipation': 0.1821}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.5482, 'negative': 0.0084, 'neutral': 0.4433}, 'topic': None}]}, {'_id': 'auth0|68194a4763d3e1aaf34b96e6', 'name': 'Luis Fernando Lee', 'email': 'luisferleerod@gmail.com', 'profilePic': 'https://res.cloudinary.com/dkm4nlyxr/image/upload/v1746655554/profileImages/j1ry8sblc3jr9sxtykep.jpg', 'birthdate': '2003-06-25', 'city': 'Bogotá', 'personality': 'Extrovertido', 'university': 'Javeriana', 'degree': 'Sistemas', 'gender': 'Masculino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-05T23:31:19.803000', 'acceptance_ip': '100.77.137.252', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '681be640838bf5f04c96183d', 'date': '2025-05-07', 'time': '18:01:20', 'text': 'hoy estuve muy feliz porque me encontré al pajas y no lo vi hace mucho tiempo y aparte lo vi caigo entonces fue una maravilla', 'emotion': 'surprise', 'emotionProbabilities': {'joy': 0.2505, 'anger': 0.0185, 'sadness': 0.024, 'disgust': 0.0099, 'fear': 0.0093, 'neutral': 0.0193, 'surprise': 0.5555, 'trust': 0.0147, 'anticipation': 0.0983}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9634, 'negative': 0.0039, 'neutral': 0.0328}, 'topic': None}, {'_id': '681d4eedf6625acec14e4bed', 'date': '2025-05-08', 'time': '19:40:13', 'text': 'estoy muy estresado la verdad es que la tesis y arquitectura no tienen consumió y no sé qué hacer con todo lo que me falta para estos días y no sé no sé si de pronto dejar todo hasta ahí o trabajar más pero una parte de mi me dice como que no paré pero de verdad estoy muy cansado no sé no quiero no quiero decepcionar a mi grupo pero estoy muy cansado de todos los días trabajar y trabajar y trabajar', 'emotion': 'sadness', 'emotionProbabilities': {'joy': 0.0218, 'anger': 0.0842, 'sadness': 0.4201, 'disgust': 0.0213, 'fear': 0.3772, 'neutral': 0.0141, 'surprise': 0.0139, 'trust': 0.0139, 'anticipation': 0.0336}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.0022, 'negative': 0.9563, 'neutral': 0.0416}, 'topic': None}, {'_id': '681e06ccf6625acec14e4bee', 'date': '2025-05-09', 'time': '08:44:44', 'text': 'el día de hoy estoy muy contenta por el cual voy a cantar una canción castime mal dicho castime castime maldicho castime castime mal dicho y hablando de otras cosas acaba salir de clase análisis numérico aparentemente es la penúltima clase porque estoy bastante cansado me falta hacer las pruebas de mi tesis casi casi que no quiere trabajar la verdad casi que me quiere hacer la tesis no sé porque se queja mucho llora mucho entonces pues nada usted lo que tenía que decir para finalizar quiere ser que casi que castime más mal dicho pintri pintin pi', 'emotion': 'joy', 'emotionProbabilities': {'joy': 0.4077, 'anger': 0.0208, 'sadness': 0.0322, 'disgust': 0.018, 'fear': 0.0078, 'neutral': 0.0989, 'surprise': 0.2567, 'trust': 0.0131, 'anticipation': 0.1449}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.006, 'negative': 0.8802, 'neutral': 0.1138}, 'topic': None}, {'_id': '681e073cf6625acec14e4bef', 'date': '2025-05-09', 'time': '08:46:36', 'text': 'luis suele llegar tarde a clase o suele llegar con muchísima hambre normalmente se duerme a clase y rara vez toma apuntes qué podremos hacer con luis', 'emotion': 'neutral', 'emotionProbabilities': {'joy': 0.089, 'anger': 0.0139, 'sadness': 0.0699, 'disgust': 0.0308, 'fear': 0.0223, 'neutral': 0.565, 'surprise': 0.0461, 'trust': 0.054, 'anticipation': 0.1091}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.0117, 'negative': 0.7272, 'neutral': 0.261}, 'topic': None}, {'_id': '681e67c1f6625acec14e4bf2', 'date': '2025-05-09', 'time': '15:38:25', 'text': 'esta es una prueba para mymin lo que yo acabo de hacer es que cambié el dack para que se ejecute cada seis horas entonces en teoría hasta dos de once tiene que leer directamente del mongo o sea el tiempo de un minuto y medio se tiene que reducir a unos veinte o treinta segundos aproximadamente', 'emotion': 'neutral', 'emotionProbabilities': {'joy': 0.0719, 'anger': 0.0145, 'sadness': 0.0333, 'disgust': 0.0486, 'fear': 0.0164, 'neutral': 0.5623, 'surprise': 0.0398, 'trust': 0.1441, 'anticipation': 0.0692}, 'sentiment': 'neutral', 'sentimentProbabilities': {'positive': 0.0264, 'negative': 0.0575, 'neutral': 0.9161}, 'topic': None}, {'_id': '6821ecfddd8819a73402f943', 'date': '2025-05-12', 'time': '07:43:41', 'text': 'y me levanta algo cansado porque estaba haciendo tesis estaba haciendo pruebas unitarias sin embargo pues todavía no han salido se supone que las tengo que entregar hoy entonces estoy un poquito estresado por eso pero pues no entonces pues espero que las sé que hoy pero que me salgan medianamente temprano para no trasnochar un día más', 'emotion': 'sadness', 'emotionProbabilities': {'joy': 0.0775, 'anger': 0.065, 'sadness': 0.3906, 'disgust': 0.0263, 'fear': 0.195, 'neutral': 0.095, 'surprise': 0.0283, 'trust': 0.0202, 'anticipation': 0.102}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.0122, 'negative': 0.6227, 'neutral': 0.3651}, 'topic': None}, {'_id': '68220943de2b0c3cfaf463f6', 'date': '2025-05-12', 'time': '09:44:19', 'text': 'el día de hoy estoy en un contexto porque había un mamá bicho que logró resolver yo la verdad no tenía mucha fe pero la verdad resolvió bastante temprano entonces creo que ya no puede hacer cositas hoy pues estoy muy feliz por eso', 'emotion': 'surprise', 'emotionProbabilities': {'joy': 0.3249, 'anger': 0.0137, 'sadness': 0.0445, 'disgust': 0.0085, 'fear': 0.0085, 'neutral': 0.068, 'surprise': 0.3402, 'trust': 0.0189, 'anticipation': 0.1727}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.8999, 'negative': 0.0055, 'neutral': 0.0946}, 'topic': None}]}, {'_id': 'auth0|681a0b789d5cb37275e749c0', 'name': 'Juan david', 'email': 'Juancasl2015@gmail.com', 'profilePic': '', 'birthdate': '2003-12-30', 'city': 'Bogotá', 'personality': 'Extrovertido', 'university': 'javeriana', 'degree': 'ingeniería De sistemas', 'gender': 'Masculino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-06T13:15:38.526000', 'acceptance_ip': '10.113.164.181', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': []}, {'_id': 'auth0|681b78b646afd5b38a6c6241', 'name': 'Gabriel', 'email': 'gabrielmoreno10@gmail.com', 'profilePic': 'https://res.cloudinary.com/dkm4nlyxr/image/upload/v1746630835/profileImages/zfomwafzsvp5uz0lla2c.jpg', 'birthdate': '1984-06-07', 'city': 'Bogotá', 'personality': 'Introvertido', 'university': 'Javeriana', 'degree': 'sistemas', 'gender': 'Masculino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-07T15:13:57.608000', 'acceptance_ip': '10.158.102.11', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '681b799f838bf5f04c961834', 'date': '2025-05-07', 'time': '10:17:51', 'text': 'acá con todos los estudiantes en una bulla y me siento triste por eso', 'emotion': 'sadness', 'emotionProbabilities': {'joy': 0.0334, 'anger': 0.0303, 'sadness': 0.7836, 'disgust': 0.017, 'fear': 0.0239, 'neutral': 0.0308, 'surprise': 0.0411, 'trust': 0.0095, 'anticipation': 0.0304}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.0015, 'negative': 0.9792, 'neutral': 0.0193}, 'topic': None}]}, {'_id': '864dc4cc-7283-4c2b-956c-6d3d8d71de2a', 'name': 'ETL Test User 864dc4cc', 'email': 'etl_test_864dc4cc@example.com', 'profilePic': 'https://example.com/pic.jpg', 'birthdate': '1990-05-15T00:00:00', 'city': 'Test City', 'personality': 'Extrovertido', 'university': 'Test University', 'degree': 'Computer Science', 'gender': 'Masculino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-12T11:49:44.101477', 'acceptance_ip': '192.168.1.100', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '74c754de-ec53-48e4-bd46-0401097eafda', 'date': '2025-05-12', 'time': '11:49:44', 'text': 'Estoy muy feliz con los resultados de las pruebas.', 'emotion': 'joy', 'emotionProbabilities': {'joy': 0.85, 'anger': 0.02, 'sadness': 0.03, 'disgust': 0.01, 'fear': 0.01, 'neutral': 0.05, 'surprise': 0.01, 'trust': 0.01, 'anticipation': 0.01}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9, 'negative': 0.05, 'neutral': 0.05}, 'topic': 'trabajo'}, {'_id': '33c8f227-498c-4fb0-81bf-029c9de7121d', 'date': '2025-05-12', 'time': '11:49:44', 'text': 'Me preocupa un poco la reunión de mañana.', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.05, 'anger': 0.1, 'sadness': 0.15, 'disgust': 0.05, 'fear': 0.55, 'neutral': 0.05, 'surprise': 0.02, 'trust': 0.02, 'anticipation': 0.01}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.1, 'negative': 0.7, 'neutral': 0.2}, 'topic': 'trabajo'}]}]
[2025-05-12T16:50:04.666+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=mymind_mongo_to_mysql_etl, task_id=extract_mongo_data, execution_date=20250512T165002, start_date=20250512T165003, end_date=20250512T165004
[2025-05-12T16:50:04.692+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-05-12T16:50:04.717+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
