[2025-05-05T04:56:01.192+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data scheduled__2025-05-05T04:55:00+00:00 [queued]>
[2025-05-05T04:56:01.200+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data scheduled__2025-05-05T04:55:00+00:00 [queued]>
[2025-05-05T04:56:01.200+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-05-05T04:56:01.215+0000] {taskinstance.py:2191} INFO - Executing <Task(_PythonDecoratedOperator): extract_mongo_data> on 2025-05-05 04:55:00+00:00
[2025-05-05T04:56:01.220+0000] {standard_task_runner.py:60} INFO - Started process 16455 to run task
[2025-05-05T04:56:01.224+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'mymind_mongo_to_mysql_etl', 'extract_mongo_data', 'scheduled__2025-05-05T04:55:00+00:00', '--job-id', '28980', '--raw', '--subdir', 'DAGS_FOLDER/mymind_etl_dag.py', '--cfg-path', '/tmp/tmp58h_pi2k']
[2025-05-05T04:56:01.225+0000] {standard_task_runner.py:88} INFO - Job 28980: Subtask extract_mongo_data
[2025-05-05T04:56:01.286+0000] {task_command.py:423} INFO - Running <TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data scheduled__2025-05-05T04:55:00+00:00 [running]> on host 9548ec498b56
[2025-05-05T04:56:01.394+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='mymind_mongo_to_mysql_etl' AIRFLOW_CTX_TASK_ID='extract_mongo_data' AIRFLOW_CTX_EXECUTION_DATE='2025-05-05T04:55:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-05-05T04:55:00+00:00'
[2025-05-05T04:56:01.396+0000] {mymind_etl_dag.py:59} INFO - Iniciando extracción desde MongoDB (usando MongoClient directo)...
[2025-05-05T04:56:01.396+0000] {mymind_etl_dag.py:63} INFO - Obteniendo detalles de conexión para mongo_mymind...
[2025-05-05T04:56:01.411+0000] {base.py:83} INFO - Using connection ID 'mongo_mymind' for task execution.
[2025-05-05T04:56:01.412+0000] {mymind_etl_dag.py:94} INFO - URI de MongoDB construida correctamente.
[2025-05-05T04:56:01.412+0000] {mymind_etl_dag.py:99} INFO - Timeouts - Connect: 10000ms, ServerSelect: 30000ms
[2025-05-05T04:56:01.412+0000] {mymind_etl_dag.py:102} INFO - Creando instancia de MongoClient...
[2025-05-05T04:56:01.419+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/pymongo/uri_parser.py:329: UserWarning: Unknown option: allow_insecure. Did you mean one of (tlsinsecure, tlsallowinvalidhostnames, tlsallowinvalidcertificates) or maybe a camelCase version of one? Refer to docstring.
  return get_validated_options(opts, warn)

[2025-05-05T04:56:01.918+0000] {mymind_etl_dag.py:112} INFO - Probando conexión con MongoDB (ping)...
[2025-05-05T04:56:03.179+0000] {mymind_etl_dag.py:114} INFO - Conexión a MongoDB exitosa.
[2025-05-05T04:56:03.180+0000] {mymind_etl_dag.py:119} INFO - Accediendo a DB: 'myMindDB-Users', Colección: 'users'
[2025-05-05T04:56:03.180+0000] {mymind_etl_dag.py:122} INFO - Realizando find en la colección...
[2025-05-05T04:56:03.265+0000] {mymind_etl_dag.py:142} INFO - Se extrajeron 5 documentos de MongoDB. Iniciando conversión de tipos BSON...
[2025-05-05T04:56:03.267+0000] {mymind_etl_dag.py:153} INFO - Conversión de tipos completada. 5 documentos listos para XCom.
[2025-05-05T04:56:03.267+0000] {mymind_etl_dag.py:164} INFO - Cerrando conexión MongoClient.
[2025-05-05T04:56:03.352+0000] {python.py:201} INFO - Done. Returned value was: [{'_id': 'auth0|67ec68c74000acd49b9bfec7', 'name': 'Test User', 'email': 'testuser@example.com', 'profilePic': 'https://new-url-pictures.com/pic.png', 'birthdate': '2000-01-01', 'city': 'Bogotá', 'personality': 'Introvertido', 'university': 'Pontificia Universidad Javeriana', 'degree': 'Ingeniería de Sistemas', 'gender': 'Masculino', 'notifications': False, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-13T01:23:00', 'acceptance_ip': '192.168.0.1', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '6817d4ae6cad195648dad37d', 'date': '2025-05-04', 'time': '15:57:18', 'text': 'hoy hable con la persona que me gusta, me senti bastante emocionado porque antes no habia tenido el valor para hablarle, pero por fin lo hice', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0263, 'anger': 0.0566, 'sadness': 0.0271, 'disgust': 0.0519, 'fear': 0.5277, 'neutral': 0.0376, 'surprise': 0.0492, 'trust': 0.0846, 'anticipation': 0.139}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9115, 'negative': 0.008, 'neutral': 0.0805}, 'topic': None}]}, {'_id': 'auth0|68056efbe5667a7f08ed848a', 'name': 'Natalia Mejia', 'email': 'nataliamejia@javeriana.edu.co', 'profilePic': 'content://media/picker_get_content/0/com.android.providers.media.photopicker/media/37', 'birthdate': '2025-04-08', 'city': 'Cali', 'personality': 'Introvertido', 'university': 'Javeriana', 'degree': 'Sistemas', 'gender': 'Femenino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-20T22:02:34.869000', 'acceptance_ip': '10.0.2.16', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': []}, {'_id': 'auth0|68ab12cd5678def90c1a2b34', 'name': 'Juan Pérez2', 'email': 'juanperez@example.com', 'profilePic': 'https://example.com/juan_avatar.png', 'birthdate': '1998-05-15', 'city': 'Medellín', 'personality': 'Extrovertido', 'university': 'Universidad de Antioquia', 'degree': 'Psicología', 'gender': 'Masculino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-10T14:30:00', 'acceptance_ip': '192.168.1.100', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '6812e789a45b123cd890ef12', 'date': '2025-04-15', 'time': '09:15:22', 'text': 'hoy tuve una presentación en la universidad y me fue increíble, todos aplaudieron y el profe me felicitó, estoy súper feliz', 'emotion': 'joy', 'emotionProbabilities': {'joy': 0.75, 'anger': 0.01, 'sadness': 0.02, 'disgust': 0.005, 'fear': 0.015, 'neutral': 0.1, 'surprise': 0.05, 'trust': 0.04, 'anticipation': 0.01}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.92, 'negative': 0.03, 'neutral': 0.05}, 'topic': 'éxito académico'}, {'_id': '6812f901b67c456ef901ab23', 'date': '2025-04-20', 'time': '17:45:10', 'text': 'se me pinchó la llanta de la bici camino a casa, tuve que caminar un montón y llegué agotado', 'emotion': 'sadness', 'emotionProbabilities': {'joy': 0.05, 'anger': 0.1, 'sadness': 0.6, 'disgust': 0.03, 'fear': 0.07, 'neutral': 0.08, 'surprise': 0.02, 'trust': 0.01, 'anticipation': 0.04}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.04, 'negative': 0.85, 'neutral': 0.11}, 'topic': 'inconveniente transporte'}]}, {'_id': 'auth0|6813c1d455192958d462175a', 'name': 'Laura Mejia Estrada', 'email': 'natismejiacil@gmail.com', 'profilePic': 'content://media/picker_get_content/0/com.android.providers.media.photopicker/media/37', 'birthdate': '2002-05-09', 'city': 'Bogota', 'personality': 'Introvertido', 'university': 'Andes', 'degree': 'Historia', 'gender': 'Femenino', 'notifications': False, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-01T18:47:48.890000', 'acceptance_ip': '192.168.80.14', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '681644e01fccea8f508ff0b2', 'date': '2025-05-03', 'time': '11:31:28', 'text': 'el día de hoy me siento bastante feliz la verdad ha sido un excelente día soy emocionada no mucha felicidad el día de hoy de verdad ha sido muy muy buen día', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0279, 'anger': 0.0647, 'sadness': 0.034, 'disgust': 0.0496, 'fear': 0.4874, 'neutral': 0.0403, 'surprise': 0.0511, 'trust': 0.0989, 'anticipation': 0.1461}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9743, 'negative': 0.0037, 'neutral': 0.022}, 'topic': None}, {'_id': '6816464b1fccea8f508ff0b4', 'date': '2025-05-03', 'time': '11:37:31', 'text': 'esta mañana tuve un par gusto muy chorro', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0641, 'anger': 0.0939, 'sadness': 0.1412, 'disgust': 0.1157, 'fear': 0.2407, 'neutral': 0.078, 'surprise': 0.0968, 'trust': 0.0704, 'anticipation': 0.0993}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.7727, 'negative': 0.0398, 'neutral': 0.1875}, 'topic': None}, {'_id': '681646591fccea8f508ff0b5', 'date': '2025-05-03', 'time': '11:37:45', 'text': 'el día de hoy me siento bastante feliz la verdad ha sido un excelente día soy emocionada no mucha felicidad el día de hoy de verdad ha sido muy muy buen día', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0279, 'anger': 0.0647, 'sadness': 0.034, 'disgust': 0.0496, 'fear': 0.4874, 'neutral': 0.0403, 'surprise': 0.0511, 'trust': 0.0989, 'anticipation': 0.1461}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9743, 'negative': 0.0037, 'neutral': 0.022}, 'topic': None}, {'_id': '681683f4f9c3a369248b83c9', 'date': '2025-05-03', 'time': '16:00:36', 'text': 'el día de hoy me siento bastante feliz la verdad ha sido un excelente día se emocionada no mucha felicidad el día de hoy de verdad ha sido muy muy buen día', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0275, 'anger': 0.0671, 'sadness': 0.0346, 'disgust': 0.0462, 'fear': 0.4983, 'neutral': 0.0395, 'surprise': 0.0478, 'trust': 0.0934, 'anticipation': 0.1457}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9741, 'negative': 0.0038, 'neutral': 0.0222}, 'topic': None}, {'_id': '6816843ef9c3a369248b83ca', 'date': '2025-05-03', 'time': '16:01:50', 'text': 'felicidad tristeza tristeza tristeza tristeza tristeza tristeza', 'emotion': 'surprise', 'emotionProbabilities': {'joy': 0.0814, 'anger': 0.0293, 'sadness': 0.055, 'disgust': 0.1061, 'fear': 0.123, 'neutral': 0.0863, 'surprise': 0.3446, 'trust': 0.0705, 'anticipation': 0.1039}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.0449, 'negative': 0.6855, 'neutral': 0.2696}, 'topic': None}, {'_id': '6816c4fa6cad195648dad375', 'date': '2025-05-03', 'time': '20:38:02', 'text': 'bueno es un buen día hice muchísimas cosas la verdad pero en general me he sentido bastante feliz y pues sí de verdad ha sido muy muy chorreto me alegra me alegra todo lo que he logrado hoy', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0279, 'anger': 0.0693, 'sadness': 0.0354, 'disgust': 0.0567, 'fear': 0.5086, 'neutral': 0.0371, 'surprise': 0.0402, 'trust': 0.0916, 'anticipation': 0.1332}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9731, 'negative': 0.0033, 'neutral': 0.0236}, 'topic': None}, {'_id': '6816c5636cad195648dad376', 'date': '2025-05-03', 'time': '20:39:47', 'text': 'no sé qué tal tal tal tal y pues felicidad tristeza tristeza hay mucha tristeza', 'emotion': 'surprise', 'emotionProbabilities': {'joy': 0.0813, 'anger': 0.0279, 'sadness': 0.0433, 'disgust': 0.1105, 'fear': 0.1074, 'neutral': 0.0867, 'surprise': 0.4118, 'trust': 0.0509, 'anticipation': 0.08}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.0094, 'negative': 0.7698, 'neutral': 0.2208}, 'topic': None}, {'_id': '6816cca06cad195648dad377', 'date': '2025-05-03', 'time': '21:10:40', 'text': 'tristeza desesperación miseria maten muerte', 'emotion': 'surprise', 'emotionProbabilities': {'joy': 0.0933, 'anger': 0.0245, 'sadness': 0.0605, 'disgust': 0.1392, 'fear': 0.055, 'neutral': 0.094, 'surprise': 0.3858, 'trust': 0.0675, 'anticipation': 0.08}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.0062, 'negative': 0.9453, 'neutral': 0.0485}, 'topic': None}, {'_id': '6817a8ca6cad195648dad379', 'date': '2025-05-04', 'time': '12:50:02', 'text': 'ay un buen día estoy en la universidad salí a comer he ido muy muy bien el día de hoy ha sido un día bastante feliz y pues sí estoy bastante feliz con todo', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0227, 'anger': 0.0585, 'sadness': 0.0278, 'disgust': 0.0366, 'fear': 0.5954, 'neutral': 0.0322, 'surprise': 0.0323, 'trust': 0.0719, 'anticipation': 0.1227}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9658, 'negative': 0.0035, 'neutral': 0.0307}, 'topic': None}, {'_id': '6817aade6cad195648dad37a', 'date': '2025-05-04', 'time': '12:58:54', 'text': 'hoy fue un excelente día tan tal tal tal taratal pues como muy buen día', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0496, 'anger': 0.1435, 'sadness': 0.0528, 'disgust': 0.057, 'fear': 0.3791, 'neutral': 0.0809, 'surprise': 0.0488, 'trust': 0.0745, 'anticipation': 0.1137}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9487, 'negative': 0.0039, 'neutral': 0.0473}, 'topic': None}]}, {'_id': 'auth0|68183fb94f8e3333cb158578', 'name': 'Mario', 'email': 'bekexin947@bocapies.com', 'profilePic': 'https://res.cloudinary.com/dkm4nlyxr/image/upload/v1746419639/profileImages/ucnoyovq8hzpcmyiqi9r.jpg', 'birthdate': '2006-05-03', 'city': 'Medellin', 'personality': 'Introvertido', 'university': 'Sabana', 'degree': 'Sistemas', 'gender': 'Femenino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-05T04:34:01.579000', 'acceptance_ip': '192.168.80.16', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': []}]
[2025-05-05T04:56:03.397+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=mymind_mongo_to_mysql_etl, task_id=extract_mongo_data, execution_date=20250505T045500, start_date=20250505T045601, end_date=20250505T045603
[2025-05-05T04:56:03.442+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-05-05T04:56:03.491+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
