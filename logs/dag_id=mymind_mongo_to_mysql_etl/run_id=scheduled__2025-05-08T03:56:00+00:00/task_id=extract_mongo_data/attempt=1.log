[2025-05-08T03:57:01.030+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data scheduled__2025-05-08T03:56:00+00:00 [queued]>
[2025-05-08T03:57:01.038+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data scheduled__2025-05-08T03:56:00+00:00 [queued]>
[2025-05-08T03:57:01.038+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-05-08T03:57:01.053+0000] {taskinstance.py:2191} INFO - Executing <Task(_PythonDecoratedOperator): extract_mongo_data> on 2025-05-08 03:56:00+00:00
[2025-05-08T03:57:01.059+0000] {standard_task_runner.py:60} INFO - Started process 94980 to run task
[2025-05-08T03:57:01.062+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'mymind_mongo_to_mysql_etl', 'extract_mongo_data', 'scheduled__2025-05-08T03:56:00+00:00', '--job-id', '41749', '--raw', '--subdir', 'DAGS_FOLDER/mymind_etl_dag.py', '--cfg-path', '/tmp/tmplyzwjmpw']
[2025-05-08T03:57:01.064+0000] {standard_task_runner.py:88} INFO - Job 41749: Subtask extract_mongo_data
[2025-05-08T03:57:01.116+0000] {task_command.py:423} INFO - Running <TaskInstance: mymind_mongo_to_mysql_etl.extract_mongo_data scheduled__2025-05-08T03:56:00+00:00 [running]> on host 52beca4b988b
[2025-05-08T03:57:01.210+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='mymind_mongo_to_mysql_etl' AIRFLOW_CTX_TASK_ID='extract_mongo_data' AIRFLOW_CTX_EXECUTION_DATE='2025-05-08T03:56:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-05-08T03:56:00+00:00'
[2025-05-08T03:57:01.211+0000] {mymind_etl_dag.py:59} INFO - Iniciando extracción desde MongoDB (usando MongoClient directo)...
[2025-05-08T03:57:01.211+0000] {mymind_etl_dag.py:63} INFO - Obteniendo detalles de conexión para mongo_mymind...
[2025-05-08T03:57:01.224+0000] {base.py:83} INFO - Using connection ID 'mongo_mymind' for task execution.
[2025-05-08T03:57:01.224+0000] {mymind_etl_dag.py:94} INFO - URI de MongoDB construida correctamente.
[2025-05-08T03:57:01.225+0000] {mymind_etl_dag.py:99} INFO - Timeouts - Connect: 10000ms, ServerSelect: 30000ms
[2025-05-08T03:57:01.225+0000] {mymind_etl_dag.py:102} INFO - Creando instancia de MongoClient...
[2025-05-08T03:57:01.231+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.8/site-packages/pymongo/uri_parser.py:329: UserWarning: Unknown option: allow_insecure. Did you mean one of (tlsinsecure, tlsallowinvalidhostnames, tlsallowinvalidcertificates) or maybe a camelCase version of one? Refer to docstring.
  return get_validated_options(opts, warn)

[2025-05-08T03:57:01.340+0000] {mymind_etl_dag.py:112} INFO - Probando conexión con MongoDB (ping)...
[2025-05-08T03:57:02.375+0000] {mymind_etl_dag.py:114} INFO - Conexión a MongoDB exitosa.
[2025-05-08T03:57:02.376+0000] {mymind_etl_dag.py:119} INFO - Accediendo a DB: 'myMindDB-Users', Colección: 'users'
[2025-05-08T03:57:02.377+0000] {mymind_etl_dag.py:122} INFO - Realizando find en la colección...
[2025-05-08T03:57:02.466+0000] {mymind_etl_dag.py:142} INFO - Se extrajeron 7 documentos de MongoDB. Iniciando conversión de tipos BSON...
[2025-05-08T03:57:02.468+0000] {mymind_etl_dag.py:153} INFO - Conversión de tipos completada. 7 documentos listos para XCom.
[2025-05-08T03:57:02.469+0000] {mymind_etl_dag.py:164} INFO - Cerrando conexión MongoClient.
[2025-05-08T03:57:02.557+0000] {python.py:201} INFO - Done. Returned value was: [{'_id': 'auth0|67ec68c74000acd49b9bfec7', 'name': 'Test User', 'email': 'testuser@example.com', 'profilePic': 'https://new-url-pictures.com/pic.png', 'birthdate': '2000-01-01', 'city': 'Bogotá', 'personality': 'Introvertido', 'university': 'Pontificia Universidad Javeriana', 'degree': 'Ingeniería de Sistemas', 'gender': 'Masculino', 'notifications': False, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-13T01:23:00', 'acceptance_ip': '192.168.0.1', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '6817d4ae6cad195648dad37d', 'date': '2025-05-04', 'time': '15:57:18', 'text': 'hoy hable con la persona que me gusta, me senti bastante emocionado porque antes no habia tenido el valor para hablarle, pero por fin lo hice', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0263, 'anger': 0.0566, 'sadness': 0.0271, 'disgust': 0.0519, 'fear': 0.5277, 'neutral': 0.0376, 'surprise': 0.0492, 'trust': 0.0846, 'anticipation': 0.139}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9115, 'negative': 0.008, 'neutral': 0.0805}, 'topic': None}, {'_id': '681baaad838bf5f04c96183a', 'date': '2025-05-07', 'time': '13:47:09', 'text': 'hoy hable con la persona que me gusta, me senti bastante emocionado porque antes no habia tenido el valor para hablarle, pero por fin lo hice', 'emotion': 'surprise', 'emotionProbabilities': {'joy': 0.2724, 'anger': 0.0239, 'sadness': 0.0263, 'disgust': 0.0106, 'fear': 0.0108, 'neutral': 0.0196, 'surprise': 0.5004, 'trust': 0.014, 'anticipation': 0.1221}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9115, 'negative': 0.008, 'neutral': 0.0805}, 'topic': None}]}, {'_id': 'auth0|68056efbe5667a7f08ed848a', 'name': 'Natalia Mejia', 'email': 'nataliamejia@javeriana.edu.co', 'profilePic': 'https://res.cloudinary.com/dkm4nlyxr/image/upload/v1746421291/profileImages/kgdhr8robviu3vdjegox.jpg', 'birthdate': '2025-04-08', 'city': 'Cali', 'personality': 'Introvertido', 'university': 'Javeriana', 'degree': 'Sistemas', 'gender': 'Femenino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-20T22:02:34.869000', 'acceptance_ip': '10.0.2.16', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '68193e4c0e9b2121ab849662', 'date': '2025-05-05', 'time': '17:40:12', 'text': 'hola tal cosa hoy fue un buen día me sentí muy feliz estuvo bien chére no pues nada todo bien y eso fue tal otra cosa no sé cuánto en', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0449, 'anger': 0.0756, 'sadness': 0.0464, 'disgust': 0.0451, 'fear': 0.5341, 'neutral': 0.0594, 'surprise': 0.0571, 'trust': 0.043, 'anticipation': 0.0944}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9236, 'negative': 0.0054, 'neutral': 0.071}, 'topic': None}]}, {'_id': 'auth0|68ab12cd5678def90c1a2b34', 'name': 'Juan Pérez2', 'email': 'juanperez@example.com', 'profilePic': 'https://example.com/juan_avatar.png', 'birthdate': '1998-05-15', 'city': 'Medellín', 'personality': 'Extrovertido', 'university': 'Universidad de Antioquia', 'degree': 'Psicología', 'gender': 'Masculino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-04-10T14:30:00', 'acceptance_ip': '192.168.1.100', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '6812e789a45b123cd890ef12', 'date': '2025-04-15', 'time': '09:15:22', 'text': 'hoy tuve una presentación en la universidad y me fue increíble, todos aplaudieron y el profe me felicitó, estoy súper feliz', 'emotion': 'joy', 'emotionProbabilities': {'joy': 0.75, 'anger': 0.01, 'sadness': 0.02, 'disgust': 0.005, 'fear': 0.015, 'neutral': 0.1, 'surprise': 0.05, 'trust': 0.04, 'anticipation': 0.01}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.92, 'negative': 0.03, 'neutral': 0.05}, 'topic': 'éxito académico'}, {'_id': '6812f901b67c456ef901ab23', 'date': '2025-04-20', 'time': '17:45:10', 'text': 'se me pinchó la llanta de la bici camino a casa, tuve que caminar un montón y llegué agotado', 'emotion': 'sadness', 'emotionProbabilities': {'joy': 0.05, 'anger': 0.1, 'sadness': 0.6, 'disgust': 0.03, 'fear': 0.07, 'neutral': 0.08, 'surprise': 0.02, 'trust': 0.01, 'anticipation': 0.04}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.04, 'negative': 0.85, 'neutral': 0.11}, 'topic': 'inconveniente transporte'}]}, {'_id': 'auth0|6813c1d455192958d462175a', 'name': 'Laura Mejia Estrada', 'email': 'natismejiacil@gmail.com', 'profilePic': 'https://res.cloudinary.com/dkm4nlyxr/image/upload/v1746425277/profileImages/eubrdbefutckduypmjts.jpg', 'birthdate': '2002-05-09', 'city': 'Bogota', 'personality': 'Introvertido', 'university': 'Andes', 'degree': 'Historia', 'gender': 'Femenino', 'notifications': False, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-01T18:47:48.890000', 'acceptance_ip': '192.168.80.14', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': []}, {'_id': 'auth0|68194a4763d3e1aaf34b96e6', 'name': 'Luis Fernando Lee', 'email': 'luisferleerod@gmail.com', 'profilePic': 'https://res.cloudinary.com/dkm4nlyxr/image/upload/v1746655554/profileImages/j1ry8sblc3jr9sxtykep.jpg', 'birthdate': '2003-06-25', 'city': 'Bogotá', 'personality': 'Extrovertido', 'university': 'Javeriana', 'degree': 'Sistemas', 'gender': 'Masculino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-05T23:31:19.803000', 'acceptance_ip': '100.77.137.252', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '681be640838bf5f04c96183d', 'date': '2025-05-07', 'time': '18:01:20', 'text': 'hoy estuve muy feliz porque me encontré al pajas y no lo vi hace mucho tiempo y aparte lo vi caigo entonces fue una maravilla', 'emotion': 'surprise', 'emotionProbabilities': {'joy': 0.2505, 'anger': 0.0185, 'sadness': 0.024, 'disgust': 0.0099, 'fear': 0.0093, 'neutral': 0.0193, 'surprise': 0.5555, 'trust': 0.0147, 'anticipation': 0.0983}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.9634, 'negative': 0.0039, 'neutral': 0.0328}, 'topic': None}]}, {'_id': 'auth0|681a0b789d5cb37275e749c0', 'name': 'Juan david', 'email': 'Juancasl2015@gmail.com', 'profilePic': '', 'birthdate': '2003-12-30', 'city': 'Bogotá', 'personality': 'Extrovertido', 'university': 'javeriana', 'degree': 'ingeniería De sistemas', 'gender': 'Masculino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-06T13:15:38.526000', 'acceptance_ip': '10.113.164.181', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '681a0c5e0e9b2121ab849666', 'date': '2025-05-06', 'time': '08:19:26', 'text': 'hola acabo de salir de la casa el día de ayer hice más a ver si soy cada paso que hoy me está oliendo demasiado o sea me dolió las piernas como esa parte si está atrás y todo pues sí por la parte de atrás no los gemelos sino atrás arriba de las piernas no sé como se llama pero uy me está oyendo demasiado igual me tocó salir pues a mantener la rutina no entonces ahorita ya estoy llegando al gimnasio creo que va a ser un día bastante pesadito en cuanto a actividad física', 'emotion': 'sadness', 'emotionProbabilities': {'joy': 0.1032, 'anger': 0.0864, 'sadness': 0.1901, 'disgust': 0.1767, 'fear': 0.1111, 'neutral': 0.081, 'surprise': 0.137, 'trust': 0.0616, 'anticipation': 0.0528}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.0095, 'negative': 0.8145, 'neutral': 0.176}, 'topic': None}, {'_id': '681a1acc0e9b2121ab849667', 'date': '2025-05-06', 'time': '09:21:00', 'text': 'bueno allá volví el gimnasio estoy bastante feliz me fue bastante bien al principio tenía un poquito como de nervios porque cuando hacer ejercicios de fuerza en los brazos casi no me gusta entonces cuando vi que a mi me tocaba hacer brazos pues estaba un poco desmotivado pero empecé a hacer los nervios si me fue bastante bien sigo cansado de sigo cansado de cuando pues del ejercicio ayer de las piernas pero me siento bastante bien y estoy muy feliz la verdad del desempeño que tuve hoy en el gimnasio', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0282, 'anger': 0.0594, 'sadness': 0.0319, 'disgust': 0.0463, 'fear': 0.5912, 'neutral': 0.0361, 'surprise': 0.0345, 'trust': 0.0714, 'anticipation': 0.1011}, 'sentiment': 'positive', 'sentimentProbabilities': {'positive': 0.8674, 'negative': 0.0136, 'neutral': 0.119}, 'topic': None}, {'_id': '681a46070e9b2121ab849668', 'date': '2025-05-06', 'time': '12:25:27', 'text': 'eh hola bueno ya llevando un novio antes creo que creo que explotó algo así pero lo que iba a decir es que básicamente continuando con el avión anterior estoy recansado me tuve en ir unas piernas a más no poder y qué o sea pues estoy creciendo soy no pero eso fue como eso y también estaba como no no quiero no sé qué pero me fue bastante bien larga quedé bastante satisfecho me fue bien me moriría en el intento entonces si eso me me vuelve a subir el ánimo sigo dolorido pero pues todo bien', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0542, 'anger': 0.0419, 'sadness': 0.0374, 'disgust': 0.1151, 'fear': 0.284, 'neutral': 0.0754, 'surprise': 0.2519, 'trust': 0.0575, 'anticipation': 0.0827}, 'sentiment': 'neutral', 'sentimentProbabilities': {'positive': 0.1764, 'negative': 0.1634, 'neutral': 0.6602}, 'topic': None}, {'_id': '681b4c5b838bf5f04c961831', 'date': '2025-05-07', 'time': '07:04:43', 'text': 'hola buenos días eso no es nada más que una prueba para ver si así que si me salgo si el audio se manda porque a ver la verdad estoy un poco preocupado con eso la verdad es que no estoy nada seguro de si de si yo llego a mandar este audio y me salgo de la aplicación si se llega a mandar o no pues vamos a ver pero no lo sé', 'emotion': 'fear', 'emotionProbabilities': {'joy': 0.0093, 'anger': 0.0308, 'sadness': 0.07, 'disgust': 0.0135, 'fear': 0.7623, 'neutral': 0.008, 'surprise': 0.0089, 'trust': 0.0698, 'anticipation': 0.0274}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.0065, 'negative': 0.7204, 'neutral': 0.2731}, 'topic': None}]}, {'_id': 'auth0|681b78b646afd5b38a6c6241', 'name': 'Gabriel', 'email': 'gabrielmoreno10@gmail.com', 'profilePic': 'https://res.cloudinary.com/dkm4nlyxr/image/upload/v1746630835/profileImages/zfomwafzsvp5uz0lla2c.jpg', 'birthdate': '1984-06-07', 'city': 'Bogotá', 'personality': 'Introvertido', 'university': 'Javeriana', 'degree': 'sistemas', 'gender': 'Masculino', 'notifications': True, 'data_treatment': {'accept_policies': True, 'acceptance_date': '2025-05-07T15:13:57.608000', 'acceptance_ip': '10.158.102.11', 'privacy_preferences': {'allow_anonimized_usage': True}}, 'transcriptions': [{'_id': '681b799f838bf5f04c961834', 'date': '2025-05-07', 'time': '10:17:51', 'text': 'acá con todos los estudiantes en una bulla y me siento triste por eso', 'emotion': 'sadness', 'emotionProbabilities': {'joy': 0.0334, 'anger': 0.0303, 'sadness': 0.7836, 'disgust': 0.017, 'fear': 0.0239, 'neutral': 0.0308, 'surprise': 0.0411, 'trust': 0.0095, 'anticipation': 0.0304}, 'sentiment': 'negative', 'sentimentProbabilities': {'positive': 0.0015, 'negative': 0.9792, 'neutral': 0.0193}, 'topic': None}]}]
[2025-05-08T03:57:02.598+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=mymind_mongo_to_mysql_etl, task_id=extract_mongo_data, execution_date=20250508T035600, start_date=20250508T035701, end_date=20250508T035702
[2025-05-08T03:57:02.638+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-05-08T03:57:02.685+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
