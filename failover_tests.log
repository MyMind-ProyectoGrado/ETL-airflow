2025-05-12 15:19:48,333 - INFO - Configurando entorno para pruebas...
2025-05-12 15:19:48,398 - INFO - Entorno configurado correctamente
2025-05-12 15:19:48,398 - INFO - ======== IT-07-01: Replicación master-slave ========
2025-05-12 15:19:48,468 - INFO - Conectando a MySQL master (localhost:3307)...
2025-05-12 15:19:48,471 - INFO - Insertando registro de prueba en master: Replication Test 064dda0e
2025-05-12 15:19:48,486 - INFO - Esperando 5 segundos para la replicación...
2025-05-12 15:19:53,487 - INFO - Conectando a MySQL slave (localhost:3308)...
2025-05-12 15:19:53,490 - INFO - Verificando registro 064dda0e-36ea-41d5-95b2-e93693d86e0a en slave...
2025-05-12 15:19:53,492 - INFO - ✅ IT-07-01: Replicación master-slave verificada exitosamente
2025-05-12 15:19:53,716 - INFO - Configurando entorno para pruebas...
2025-05-12 15:19:53,783 - INFO - Entorno configurado correctamente
2025-05-12 15:19:53,783 - INFO - ======== IT-07-02: Simulación de fallo en master ========
2025-05-12 15:19:53,783 - INFO - Conectando a MySQL master (localhost:3307)...
2025-05-12 15:19:53,786 - INFO - Insertando registro de prueba en master antes del failover: Failover Test e04ffef9
2025-05-12 15:19:53,791 - INFO - Esperando 5 segundos para la replicación...
2025-05-12 15:19:58,791 - INFO - Simulando fallo del master...
2025-05-12 15:19:58,792 - INFO - Deteniendo contenedor mysql_mymind_master...
2025-05-12 15:20:09,020 - INFO - Contenedor mysql_mymind_master detenido
2025-05-12 15:20:09,020 - INFO - Ejecutando script de failover...
2025-05-12 15:20:09,021 - INFO - Ejecutando script de failover...
2025-05-12 15:20:09,021 - INFO - Usando script de failover: /home/lflee/airflow/mysql/failover.sh
2025-05-12 15:20:09,320 - INFO - Esperando 15 segundos para que el failover se complete...
2025-05-12 15:20:24,320 - INFO - Conectando a nuevo master (anteriormente slave) localhost:3308...
2025-05-12 15:20:24,323 - INFO - Verificando que podemos leer el registro existente e04ffef9-92f0-43d6-980a-6aa13574bd63...
2025-05-12 15:20:24,325 - INFO - Insertando nuevo registro en el nuevo master: bc5cdca1-4fd0-4857-8e54-574e9d068b97...
2025-05-12 15:20:24,332 - INFO - ✅ IT-07-02: Simulación de failover completada exitosamente
2025-05-12 15:20:24,536 - INFO - Configurando entorno para pruebas...
2025-05-12 15:20:24,604 - INFO - Configurando replicación con: /home/lflee/airflow/mysql/setup-replication.sh
2025-05-12 15:20:45,112 - ERROR - No se pudo configurar la replicación: {'slave_io_running': False, 'slave_sql_running': False, 'status_ok': False}
2025-05-12 15:20:45,112 - INFO - ======== IT-07-03: Continuidad de operaciones ========
2025-05-12 15:20:45,112 - INFO - Conectando a nuevo master (anteriormente slave) localhost:3308...
2025-05-12 15:20:45,117 - INFO - Insertando nuevo usuario 3e9b3114-bb66-4347-93f3-19b5116b2333...
2025-05-12 15:20:45,118 - INFO - Insertando transcripción acf4354f-26a0-4be0-9904-9897277ef1ae para usuario 3e9b3114-bb66-4347-93f3-19b5116b2333...
2025-05-12 15:20:45,119 - INFO - Actualizando usuario 3e9b3114-bb66-4347-93f3-19b5116b2333...
2025-05-12 15:20:45,120 - INFO - Ejecutando consulta JOIN...
2025-05-12 15:20:45,124 - INFO - ✅ IT-07-03: Continuidad de operaciones verificada exitosamente
2025-05-12 15:20:45,326 - INFO - Configurando entorno para pruebas...
2025-05-12 15:20:45,408 - INFO - Configurando replicación con: /home/lflee/airflow/mysql/setup-replication.sh
2025-05-12 15:21:05,889 - ERROR - No se pudo configurar la replicación: {'slave_io_running': False, 'slave_sql_running': False, 'status_ok': False}
2025-05-12 15:21:05,889 - INFO - ======== IT-08-01: Ejecución ETL post-failover ========
2025-05-12 15:21:05,889 - INFO - Ejecutando DAG de ETL después del failover...
2025-05-12 15:21:05,889 - INFO - Ejecutando DAG de ETL con tiempo de espera de 60 segundos...
2025-05-12 15:21:05,909 - INFO - Contenedor de Airflow encontrado: ed9b017ef178
2025-05-12 15:21:09,047 - INFO - DAG mymind_mongo_to_mysql_etl iniciado exitosamente, esperando 60 segundos...
2025-05-12 15:22:11,885 - INFO - Estado del DAG: None

2025-05-12 15:22:11,885 - INFO - ✅ IT-08-01: Ejecución ETL post-failover verificada exitosamente
2025-05-12 15:22:12,080 - INFO - Configurando entorno para pruebas...
2025-05-12 15:22:12,153 - INFO - Configurando replicación con: /home/lflee/airflow/mysql/setup-replication.sh
2025-05-12 15:22:32,631 - ERROR - No se pudo configurar la replicación: {'slave_io_running': False, 'slave_sql_running': False, 'status_ok': False}
2025-05-12 15:22:32,631 - INFO - ======== IT-08-02: Actualización de conexión Airflow ========
2025-05-12 15:22:32,652 - INFO - Verificando conexión actual en Airflow...
2025-05-12 15:22:35,177 - INFO - Ejecutando un DAG para verificar la conexión...
2025-05-12 15:22:38,312 - INFO - ✅ IT-08-02: Actualización de conexión Airflow verificada exitosamente
